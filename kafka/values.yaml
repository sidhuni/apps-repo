auth:
  # Disable SASL/TLS authentication for simple local use
  enabled: false

listeners:
  client:
    # Use unsecured plaintext protocol
    protocol: PLAINTEXT

# Use the legacy image repository to resolve ErrImagePull issues
image:
  repository: bitnamilegacy/kafka
  # We omit the tag here; it will default to a stable tag used by chart 32.4.3

defaultInitContainers:
  prepareConfig:
    image:
      repository: bitnamilegacy/kafka

# --- 2. LOCAL CLUSTER SIZING ---
controller:
  # Use a single controller/broker for resource efficiency on a Mac (KRaft mode)
  replicaCount: 1

resources:
  # Set reasonable limits for Rancher Desktop to prevent crashes
  requests:
    memory: "512Mi"
    cpu: "250m"
  limits:
    memory: "1024Mi"
    cpu: "500m"

# --- 3. ARGOCD STABILITY FIXES (REQUIRED FOR SYNC STATUS) ---

# This instructs the Helm chart to look for an existing secret containing the
# stable cluster ID instead of generating a new one every time.
# NOTE: The secret 'my-kafka-cluster-kraft' MUST be created manually beforehand.
kraft:
  clusterIdSecret: my-kafka-cluster-kraft

# This is the final, most robust fix for the Out-of-Sync problem.
# It tells Helm to deploy the secrets/configmaps once and then STOP managing them.
# This stabilizes the checksum annotations on the StatefulSet.
commonAnnotations:
  "helm.sh/resource-policy": keep