# In: https://github.com/sidhuni/tools-app.git/kafka/values.yaml

# --- Core Kafka Configuration (Unsecured, Legacy Images) ---

auth:
  enabled: false

listeners:
  client:
    protocol: PLAINTEXT

# Use legacy images due to Bitnami's repository migration
image:
  repository: bitnamilegacy/kafka

defaultInitContainers:
  prepareConfig:
    image:
      repository: bitnamilegacy/kafka

# Ensure the controller starts up fast for local Rancher Desktop testing
controller:
  replicaCount: 1

# Provide basic resource limits to prevent pod failure on small clusters
resources:
  requests:
    memory: "512Mi"
    cpu: "250m"
  limits:
    memory: "1024Mi"
    cpu: "500m"

# =================================================================
# === ARGOCD STABILITY FIXES ===
# =================================================================

# 1. Instruct the Helm Chart to use an existing KRaft Cluster ID secret.
#    (This must be created via kubectl first to stabilize the cluster ID)
kraft:
  clusterIdSecret: my-kafka-cluster-kraft

# 2. Add the Helm Resource Policy Annotation (The Sync Fix)
commonAnnotations:
  # This annotation tells Helm: "Do not touch the resource once created."
  # This is crucial for secrets and configmaps that get auto-generated data,
  # preventing the endless Out of Sync loop in ArgoCD.
  "helm.sh/resource-policy": keep