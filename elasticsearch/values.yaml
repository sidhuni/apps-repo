clusterName: "elasticsearch"
nodeGroup: "master"

# Use Official Elastic Image
image: "docker.elastic.co/elasticsearch/elasticsearch"
imageTag: "8.5.1"
imagePullPolicy: "IfNotPresent"

# --- THE CRITICAL FIXES ---
extraEnvs:
  - name: "discovery.type"
    value: "single-node"

# Setting this to null stops the chart from injecting cluster.initial_master_nodes
# which causes the 'Illegal Argument' / 'Parse' exceptions we saw.
minimumMasterNodes: null

# Local dev should only be 1 replica for resource efficiency
replicas: 1

# Resource limits (Elastic 8.x needs 2Gi to initialize security successfully)
resources:
  requests:
    cpu: "500m"
    memory: "2Gi"
  limits:
    cpu: "1000m"
    memory: "2Gi"

# Give JVM half of the available memory
esJavaOpts: "-Xmx1g -Xms1g"

# Persistence settings for Rancher Desktop
volumeClaimTemplate:
  accessModes: ["ReadWriteOnce"]
  resources:
    requests:
      storage: 5Gi

# Enable security (Standard for 8.x)
createCert: true

# Service config
service:
  type: ClusterIP
  httpPort: 9200

# Disable the init container image pull and use the manual host fix
sysctlInitContainer:
  enabled: false

# Acceptance criteria for a 1-node cluster
clusterHealthCheckParams: "wait_for_status=yellow&timeout=1s"

# Patience for first-time boot (generating certs takes time on Mac)
readinessProbe:
  initialDelaySeconds: 120
  periodSeconds: 60
  successThreshold: 3
  timeoutSeconds: 5